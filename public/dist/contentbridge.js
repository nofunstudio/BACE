(()=>{"use strict";var e={1761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectByUUID=t.cssStringToHexNumber=t.hexNumberToCSSString=t.getEntityName=t.isUUID=void 0;const s=/^([a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}){1}$/;t.isUUID=e=>"string"==typeof e&&s.test(e),t.getEntityName=e=>e.name||e.baseType,t.hexNumberToCSSString=e=>`#${("000000"+e.toString(16)).slice(-6)}`,t.cssStringToHexNumber=e=>+`0x${e.substr(1)}`,t.getObjectByUUID=(e,s)=>{if(e.uuid===s)return e;if(!e.children||!e.children.length)return null;for(let n of e.children){let e=(0,t.getObjectByUUID)(n,s);if(e)return e}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}(()=>{s(1761);class e extends EventTarget{constructor(){super(),this.db=new Map,this.overviews=new Map,this.sceneGraphs=new Map,this.renderers=new Map,this.renderingInfo=new Map,this.port=chrome.runtime.connect({name:"r3f-devtools"}),this.port.postMessage({name:"connect",tabId:chrome.devtools.inspectedWindow.tabId}),this.port.onDisconnect.addListener((e=>{console.error("disconnected from background",e)})),this.port.onMessage.addListener((e=>{this.onMessage(e),console.log(e)})),document.addEventListener("keydown",(e=>{e.key}),{passive:!0})}reload(){chrome.devtools.inspectedWindow.reload({})}getEntity(e){return e?/renderer/.test(e)?this.renderers.get(e):this.db.get(e):{uuid:e}}getEntityandDependencies(e){const t={},s=[e];for(;s.length;){const e=s.shift();if(e){const n=this.getEntity(e);if(n&&e&&!t[e]){t[e]=n;for(let e of Object.values(n))(0,utils_1.isUUID)(e)&&s.push(e)}}}return t}getRenderingInfo(e){return this.renderingInfo.get(e)}getResourcesOverview(e){return this.overviews.get(e)}getSceneGraph(e){return this.sceneGraphs.get(e)}updateProperty(e,t,s,n){const i=this.getEntity(e);this.dispatchToContent("entity-update",{uuid:e,property:t,value:s,dataType:n}),i[t]=s,this.update(i)}requestEntity(e){this.dispatchToContent("_request-entity",{uuid:e})}requestOverview(e){this.dispatchToContent("_request-overview",{type:e})}requestSceneGraph(e){this.dispatchToContent("_request-scene-graph",{uuid:e})}requestRenderingInfo(e){this.dispatchToContent("_request-rendering-info",{uuid:e})}select(e){e&&this.dispatchToContent("select",{uuid:e})}onMessage(e){const{id:t,type:s,data:n}=e;switch(s){case"error":this.dispatchEvent(new CustomEvent("error",{detail:n}));break;case"register":this.revision=n.revision,this.eval(`console.log("r3f-devtools: debugging three.js r${this.revision}")`);break;case"injection":this.db.clear(),this.overviews.clear(),this.sceneGraphs.clear(),this.renderers.clear(),this.renderingInfo.clear(),n(),this.dispatchEvent(new CustomEvent("devtools-ready"));break;case"observe":this.dispatchEvent(new CustomEvent("observe",{detail:{uuids:n.uuids}}));break;case"scene-graph":this.sceneGraphs.set(n.uuid,n.graph),this.dispatchEvent(new CustomEvent("scene-graph-update",{detail:{uuid:n.uuid,graph:n.graph}}));break;case"overview":this.overviews.set(n.type,n.entities),this.dispatchEvent(new CustomEvent("overview-update",{detail:{type:n.type,entities:n.entities}}));break;case"rendering-info":this.dispatchEvent(new CustomEvent("rendering-info-update",{detail:n})),this.renderingInfo.set(n.uuid,n);break;case"entity":if("renderer"===n.type)this.renderers.set(n.uuid,n),this.dispatchEvent(new CustomEvent("renderer-update",{detail:{renderer:n,uuid:n.uuid}}));else if(Array.isArray(n))for(let e of n)this.update(e)}}update(e){this.db.set(e.uuid,e),this.dispatchEvent(new CustomEvent("entity-update",{detail:{entity:e,uuid:e.uuid}}))}dispatchToContent(e,t){this.eval(`__R3F_DEVTOOLS__.dispatchEvent(new CustomEvent('${e}', {\n      detail: ${JSON.stringify(t)},\n    }));`)}eval(e){const[t,s]=chrome.devtools.inspectedWindow.eval(e);return s&&console.warn(s),t}}})()})();